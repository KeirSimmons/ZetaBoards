dynamo.notifications={version:9,settings:dynamo.server.modules.notifications.settings,__construct:function(){console.log("loaded"),dynamo.tip.preloaded.add_msg([["notifications-log-1",{type:5,message:"You do not have any new notifications.",title:dynamo.server.modules.notifications.name+" - Unread"}],["notifications-log-2",{type:5,message:"You do not have any old notifications.",title:dynamo.server.modules.notifications.name+" - History"}],["notifications-log-3",{type:5,message:"The notification could not be marked as read.",title:dynamo.server.modules.notifications.name}],["notifications-log-4",{type:5,message:"The notification has been marked as read.",title:dynamo.server.modules.notifications.name}],["notifications-log-5",{type:5,message:"The notifications could not be marked as read.",title:dynamo.server.modules.notifications.name}],["notifications-log-6",{type:5,message:"The notifications have all been marked as read.",title:dynamo.server.modules.notifications.name}],["notifications-log-7",{type:5,message:"Your settings were not updated successfully. Please try again later.",title:dynamo.server.modules.notifications.name+" - Settings"}],["notifications-log-8",{type:5,message:"Your settings were updated successfully.",title:dynamo.server.modules.notifications.name+" - Settings"}]])},shown:[],info:{custom:"%DATA[data]%","core-announcement":"<strong>Official Announcement: </strong><br>%DATA[data]%","core-name_change":"Your request for a name change to <strong>%DATA[data]%</strong> has been approved.","currency-donation":"<a href='"+main_url+"profile/%DATA[data_zbid]%/'>%DATA[username]%</a> has sent you a donation of %MODULE[currency,settings,symbol]%%DATA[data]%.<div class='dynamo_tooltip_hide'>[<a href='javascript:dynamo.tip.prompt.ini(\".dynamo_currency_transactionhistory\");'>Transaction History</a>]</div>","currency-user_money_edit_plus":"An admin has increased your balance by %MODULE[currency,settings,symbol]%%DATA[data,number]%.<div class='dynamo_tooltip_hide'>[<a href='javascript:dynamo.tip.prompt.ini(\".dynamo_currency_transactionhistory\");'>Transaction History</a>]</div>","currency-user_money_edit_minus":"An admin has decreased your balance by %MODULE[currency,settings,symbol]%%DATA[data,number]%.<div class='dynamo_tooltip_hide'>[<a href='javascript:dynamo.tip.prompt.ini(\".dynamo_currency_transactionhistory\");'>Transaction History</a>]</div>","lottery-result":"You won %MODULE[currency,settings,symbol]%%DATA[data]% in the %MODULE[lottery,settings,name]%.<div class='dynamo_tooltip_hide'>[<a href='javascript:dynamo.tip.prompt.ini(\".dynamo_lottery_previous\");'>%MODULE[lottery,settings,name]% History</a>]</div>","level-levelled_up":"Congratulations! You are now %MODULE[level,settings,level_name]% %DATA[data,number]%.","level-user_exp_edit_plus":"An admin has increased your %MODULE[level,settings,exp_name]% by %DATA[data,number]%.","level-user_exp_edit_minus":"An admin has decreased your %MODULE[level,settings,exp_name]% by %DATA[data,number]%.","member_tag-tag":"<a href='"+main_url+"profile/%DATA[data_zbid]%'>%DATA[data,split,||,0]%</a> has tagged you in <a href='"+main_url+"topic/%DATA[data,split,||,1]%/findpost/%DATA[data,split,||,2]%'>this post</a>.","post-position_increase":"Congratulations! You are now %DATA[data]% in the post competition.","post-position_decrease":"You've been overtaken! You are now %DATA[data]% in the post competition.","post-position_entered":"You have now entered the post competition and are currently in %DATA[data]% place."},get_info:function(t){if(t.type in dynamo.notifications.info){var n=dynamo.notifications.info[t.type];return n=[dynamo.toolbox.dynamic_text_replace(dynamo.toolbox.time_string(t.time,2),t),dynamo.toolbox.dynamic_text_replace(n,t)]}return["Notification","<em>N/A</em>"]},show:function(t){var n,e=function(n){var e=dynamo.notifications.get_info(t[n]),o=t[n].id;dynamo.toolbox.in_array(o,dynamo.notifications.shown)||(dynamo.notifications.shown[dynamo.notifications.shown.length]=o,dynamo.tip.growl.show({message:e[1],title:e[0],events:{hide:function(){dynamo.module.server_call(2,{m:"notifications",p1:"read",info:{id:t[n].id}})}}}))};for(n in t)e(n)},logs:{show:function(t){var n=t.info,e=n.logs,o=e.length,a=n.page,i=n.total_pages,s=$("<button>").attr("type","submit").css("width","80px").html("<").css("opacity",.5).addClass("dynamo_prev_page"),r=$("<button>").attr("type","submit").css("width","80px").html(">").css("opacity",.5).addClass("dynamo_next_page"),d=[{content:"When",style:{width:"30%"},type:"th"},{content:"Message",type:"th"}];0==n.read&&(d[1].style={width:"50%"},d[2]={content:"Mark as Read",type:"th"});var c=[];0==n.read&&(c[c.length]={cells:[{colspan:3,style:{align:"center"},content:'[<a href="javascript:dynamo.notifications.logs.mark_all();">Mark all as read</a>]'}]}),c[c.length]={cells:d};var m,l;for(m=0;o>m;m++)"name"in e[m]&&(e[m].name=""==e[m].name?"user_info"in n&&"zbid-"+e[m].data_zbid in n.user_info?n.user_info["zbid-"+e[m].data_zbid]:"Unknown":e[m].name),l=dynamo.notifications.get_info(e[m]),d=[{content:dynamo.toolbox.time_string(e[m].time,2)},{content:l[1]}],0==n.read&&(d[2]={content:'[<a href="javascript:dynamo.notifications.logs.read('+e[m].id+');">read</a>]'}),c[c.length]={cells:d};dynamo.tip.prompt.content(function(){$(".dynamo_content").empty().append('<div></div><br /><div style="text-align:center;" class="dynamo_pages_holder"></div>'),dynamo.table.create(".dynamo_content div:first",{colspan:0==n.read?3:2,rows:c}),$(".dynamo_pages_holder").append(s).append(" ").append(r),$(".dynamo_content em").css("opacity",.5),a>1&&$(".dynamo_prev_page").bind("click",function(){dynamo.tip.prompt.load({m:"notifications",p1:"log",c:0==n.read?"new":"old",info:{page:a-1}})}).css("opacity",1),i>a&&$(".dynamo_next_page").bind("click",function(){dynamo.tip.prompt.load({m:"notifications",p1:"log",c:0==n.read?"new":"old",info:{page:a+1}})}).css("opacity",1)},dynamo.server.modules.notifications.name+" - "+((0==n.read?"Unread":"History")+" - Page "+a+" / "+i),700)},read:function(t){dynamo.tip.prompt.load({m:"notifications",p1:"log",c:"read",info:{id:t}})},mark_all:function(){dynamo.tip.prompt.load({m:"notifications",p1:"log",c:"mark_all"})}},settings:{form:function(t){dynamo.tip.prompt.content(function(){dynamo.form.create(".dynamo_content",{fields:[{field:{type:"input",spec:"number",name:"perpage"},content:{label:"Notifications per page",desc:"Number of new notifications to show as a popup on each page (when available).<br><br>Set this to zero to not receive popups (you can still check your notifications via the User CP).",value:t.info.perpage},rules:{required:!0,min:0,max:t.info.max}}],submit:{to_call:function(t){dynamo.tip.prompt.load({m:"notifications",p1:"settings",c:"edit",info:t})},value:"Edit",inline:!0}})},dynamo.server.modules.notifications.name+" - Settings")}}};