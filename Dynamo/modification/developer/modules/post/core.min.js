dynamo.post={version:1,settings:dynamo.server.modules.post.settings,__construct:function(){dynamo.tip.preloaded.add_msg([["post-acp-current-1",{type:5,message:"The competition could not be created."}],["post-acp-current-2",{type:5,message:"The competition has been created successfully."}],["post-current-1",{type:5,message:"There aren't any post competitions running at the moment."}]])},acp:{current:{off:{form:function(){dynamo.tip.prompt.content(function(){dynamo.form.create(".dynamo_content",{fields:[{field:{type:"input",spec:"number",name:"end_date"},content:{label:"Proposed end date",desc:"Input the number of seconds that the post competition should last for.<br><br>3,600 seconds = 1 hour<br>86,400 seconds = 1 day",placeholder:0,value:0},rules:{required:!0,min:1}}],submit:{to_call:function(t){dynamo.tip.prompt.load({m:"post",p1:"acp",p2:"current",c:"create",info:t})},value:"Start",inline:!1}}),$(".dynamo_content form tr:first").before('<tr><th colspan="2">Information</th></tr><tr><td colspan="2">Use this form to start a post competition with a proposed end date. The competition will not end automatically - please come back to end it manually.</td></tr>')},dynamo.server.modules.post.name+" - ACP - Current Competition")}},on:{early:function(t){var e=dynamo.toolbox.format_number(t.info.total_posts),n=dynamo.toolbox.format_number(t.info.participants),o=dynamo.toolbox.time_string(t.info.time_left,1);dynamo.tip.prompt.content(function(){var t=[{cells:[{content:"Field",type:"th",style:{width:"50%"}},{content:"Value",type:"th"}]},{cells:[{content:"Total posts",style:{classes:"c_desc"}},{content:e}]},{cells:[{content:"Participants",style:{classes:"c_desc"}},{content:n}]},{cells:[{content:"Ending in",style:{classes:"c_desc"}},{content:o+' [<a href="javascript:dynamo.post.acp.current.on.end();">End Early</a>]'}]}];dynamo.table.create(".dynamo_content",{rows:t})},dynamo.server.modules.post.name+" - ACP - Current Competition")},end:function(){dynamo.tip.prompt.load({m:"post",p1:"acp",p2:"current",c:"end"})}},ended:function(t){dynamo.tip.prompt.content(function(){var e=[{cells:[{content:"Information",colspan:3,type:"th"}]},{cells:[{content:"The competition has ended. The winners are presented below; please save this data yourself as once you navigate away you will not be able to retrieve the winners again.",colspan:3}]},{cells:[{content:"Position",type:"th",style:{width:"25%"}},{content:"User",type:"th",style:{width:"50%"}},{content:dynamo.server.modules.post.settings.points_name,type:"th"}]}],n=t.info.winners;console.log(n);var o,s,a,r,c=1,i=["Position - ZBID - Username - Profile Link - Points"];for(var l in n)o=n[l],s=main_url+"profile/"+o.zbid,a='<a href="'+s+'">'+o.username+"</a>",r=dynamo.toolbox.format_number(o.points,dynamo.server.modules.post.settings.decimals),e[e.length]={cells:[{content:"#"+c},{content:a},{content:r}]},i[i.length]=c++ +" - "+o.zbid+" - "+o.username+" - "+s+" - "+r;e[e.length]=1==c?{cells:[{content:"No one earned any "+dynamo.toolbox.lowercase(dynamo.server.modules.post.settings.points_name)+" in this competition.",colspan:3}]}:{cells:[{content:'<textarea rows="5">'+i.join("\n")+"</textarea>",colspan:3}]},dynamo.table.create(".dynamo_content",{rows:e,colspan:3})},dynamo.server.modules.post.name+" - ACP - Current Competition - Results")}}},current:function(t){console.log(t),dynamo.tip.prompt.content(function(){$(".dynamo_content").html("<div /><br /><div />");var e,n=[{cells:[{content:"Position",type:"th",style:{width:"25%"}},{content:"User",type:"th",style:{width:"50%"}},{content:dynamo.server.modules.post.settings.points_name,type:"th"}]}],o=1;for(var s in t.info.leaderboard)e=t.info.leaderboard[s],n[n.length]={cells:[{content:"#"+o++},{content:'<a href="'+main_url+"profile/"+e.zbid+'">'+e.username+"</a>"},{content:dynamo.toolbox.format_number(e.points,dynamo.server.modules.post.settings.decimals)}]};1==n.length&&(n[2]={cells:[{content:"The leaderboard is currently empty.",colspan:3}]}),dynamo.table.create(".dynamo_content div:eq(0)",{rows:n,colspan:3}),dynamo.table.create(".dynamo_content div:eq(1)",{rows:[{cells:[{content:"My Position",style:{width:"50%",classes:"c_desc"}},{content:0==+t.info.position?"Unranked":"#"+dynamo.toolbox.format_number(t.info.position)}]},{cells:[{content:"My "+dynamo.server.modules.post.settings.points_name,style:{width:"50%",classes:"c_desc"}},{content:dynamo.toolbox.format_number(t.info.points,dynamo.server.modules.post.settings.decimals)}]}]})},dynamo.server.modules.post.name+" - Current Competition"+(t.info.ended?" (ENDED)":""))}};